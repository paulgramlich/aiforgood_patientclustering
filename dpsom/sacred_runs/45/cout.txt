INFO - hyperopt - Running command 'main'
INFO - hyperopt - Started run with ID "45"
using LBP
[8. 8. 0. 8. 8. 6. 5. 8. 8. 3. 5. 8. 8. 7. 8. 8. 0. 8. 7. 6. 5. 0. 7. 0.
 5. 8. 0. 0. 7. 8. 0. 5. 0. 8. 7. 0. 7. 5. 7. 8. 6. 4. 0. 5. 8. 0. 0. 0.
 8. 7. 8. 0. 8. 0. 8. 5. 6. 7. 8. 4. 7. 7. 0. 7. 6. 0. 7. 8. 5. 8. 8. 5.
 0. 5. 0. 8. 5. 7. 8. 7. 5. 5. 7. 8. 8. 0. 0. 0. 0. 6. 8. 8. 0. 5. 0. 7.
 0. 0. 8. 7. 8. 7. 8. 8. 0. 5. 5. 8. 7. 8. 7. 0. 0. 7. 7. 0. 8. 8. 0. 0.
 8. 8. 8. 5. 8. 7. 0. 0. 8. 5. 8. 0. 8. 0. 8. 8. 0. 8. 7. 0. 5. 0. 8. 7.
 0. 7. 6. 0. 8. 8. 7. 0. 0. 5. 8. 7. 8. 8. 0. 0. 5. 8. 0. 5. 7. 8. 8. 0.
 8. 7. 4. 7. 7. 0. 6. 8. 8. 8. 8. 7. 8. 5. 8. 8. 8. 8. 5. 8. 6. 5. 0. 8.
 8. 6. 8. 8. 0. 0. 8. 8. 0. 8. 0. 8. 0. 5. 0. 8. 7. 0. 0. 4. 8. 8. 4. 8.
 7. 4. 0. 5. 8. 7. 4. 8. 0. 6. 7. 8. 8. 8. 8. 7. 5. 6. 8. 0. 8. 8. 7. 7.
 8. 8. 8. 0. 8. 5. 8. 0. 6. 6. 0. 6. 4. 0. 7. 8. 8. 0. 8. 8. 7. 8. 8. 6.
 0. 8. 8. 0. 0. 0. 0. 8. 8. 0. 8. 7. 8. 8. 0. 6. 0. 7. 8. 0. 7. 8. 5. 6.
 0. 8. 7. 0. 8. 7. 8. 7. 6. 8. 8. 8. 7. 0. 0. 3. 8. 0. 0. 7. 6. 0. 6. 8.
 8. 0. 8. 0. 8. 8. 8. 8. 8. 0. 8. 0. 0. 6. 0. 0. 0. 0. 0. 6. 8. 8. 0. 0.
 5. 7. 0. 8. 8. 8. 7. 8. 8. 5. 0. 8. 0. 8. 0. 7. 0. 0. 7. 5. 8. 8. 5. 7.
 5. 7. 6. 0. 8. 0. 7. 6. 6. 7. 0. 6. 7. 8. 0. 8. 0. 0. 8. 7. 8. 8. 6. 6.
 8. 7. 0. 7. 8. 8. 5. 8. 6. 8. 7. 5. 7. 5. 7. 8. 0. 8. 7. 7. 7. 7. 8. 6.
 0. 5. 6. 8. 8. 6. 0. 0. 8. 5. 0. 8. 8. 7. 8. 8. 5. 6. 5. 8. 8. 7. 8. 8.
 7. 8. 7. 7. 8. 0. 6. 7. 0. 6. 8. 8. 5. 8. 0. 7. 7. 0. 6. 8. 7. 8. 8. 8.
 8. 0. 8. 7. 6. 8. 8. 5. 8. 0. 8. 7. 8. 7. 0. 0. 7. 6. 8. 0. 0. 8. 0. 7.
 0. 7. 8. 0. 7. 5. 0. 0. 7. 0. 7. 0. 0. 8. 8. 7. 8. 8. 8. 7. 8. 3. 8. 8.
 3. 5. 8. 7. 6. 0. 7. 8. 5. 7. 0. 0. 8. 0. 8. 7. 8. 7. 8. 7. 5. 7. 0. 8.
 8. 7. 7. 8. 0. 5. 8. 7. 8. 5. 7. 8. 5. 8. 8. 6. 0. 0. 0. 8. 5. 7. 8. 8.
 8. 5. 0. 0. 8. 8. 0. 7. 8. 6. 0. 0. 7. 8. 0. 5. 0. 7. 8. 0. 0. 0. 5. 0.
 0. 6. 0. 8. 5. 6. 8. 5. 8. 0. 8. 0. 7. 6. 0. 0. 8. 5. 0. 5. 8. 0. 8. 0.
 0. 8. 8. 8. 7. 0. 0. 8. 8. 6. 8. 0. 0. 0. 8. 0. 7. 8. 0. 7. 6. 8. 6. 0.
 7. 7. 5. 8. 6. 8. 0. 7. 0. 8. 0. 5. 5. 7. 7. 0. 6. 7. 4. 7. 8. 4. 8. 7.
 8. 6. 0. 7. 8. 8. 6. 0. 0. 6. 7. 4. 0. 2. 0. 0. 8. 0. 8. 7. 8. 8. 0. 5.
 8. 0. 7. 0. 7. 5. 0. 7. 8. 8. 5. 5. 0. 8. 8. 7. 6. 7. 8. 8. 8. 0. 0. 0.
 7. 0. 8. 8. 0. 8. 6. 8. 8. 8. 0. 8. 7. 7. 0. 0. 0. 6. 5. 0. 8. 8. 6. 7.
 8. 8. 0. 7. 0. 8. 0. 7. 0. 8. 0. 0. 8. 7. 0. 8. 0. 7. 8. 5. 8. 3. 7. 5.
 0. 0. 8. 5. 0. 3. 8. 0. 8. 7. 0. 8. 7. 8. 5. 7. 0. 8. 7. 8. 8. 0. 0. 0.
 8. 5. 7. 0. 8. 5. 7. 8. 5. 7. 5. 0. 0. 0. 8. 7. 0. 7. 8. 7. 5. 7. 5. 8.
 0. 0. 5. 6. 7. 8. 5. 5. 0. 8. 0. 8. 5. 5. 7. 7. 8. 8. 0. 8. 5. 0. 6. 8.
 7. 7. 8. 8. 7. 6. 7. 7. 6. 8. 3. 7. 8. 7. 5. 0. 5. 8. 7. 0. 5. 6. 8. 0.
 6. 5. 0. 0. 4. 7. 7. 8. 8. 6. 8. 7. 5. 8. 6. 0. 0. 0. 2. 8. 8. 8. 8. 8.
 8. 0. 8. 0. 0. 8. 7. 8. 7. 8. 6. 5. 8. 8. 8. 8. 0. 7. 8. 7. 0. 0. 8. 0.
 5. 8. 0. 8. 0. 8. 8. 8. 8. 8. 8. 0. 8. 0. 0. 7. 8. 0. 8. 7. 0. 0. 6. 7.
 0. 8. 7. 8. 0. 8. 8. 5. 7. 8. 7. 6. 0. 7. 0. 6.]
num_features: 359
data_train_padded.shape: (928, 784)
data_train.shape: (394, 28, 28, 1), data_val.shape: (70, 28, 28, 1), data_test.shape: (464, 28, 28, 1)
Initializing global variables...
2024-06-19 16:44:50.049024: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:388] MLIR V1 optimization pass is not enabled
Variables initialized.

**********Starting job hyperopt_100_8-8_2024-06-19_21164********* 

  0%|          | 0/205 [00:00<?, ?it/s]Number of batches: 1


Autoencoder Pretraining...

Starting epoch 1/15
Batch 1/1
Batch data shape: (200, 28, 28, 1)
Train Loss: 567.9610595703125
Running validation...
Epoch 1, Step 0: Train Loss = 551.239990234375, Test Loss = 551.3260498046875
  0%|          | 1/205 [00:00<01:10,  2.88it/s, epoch=0, test_loss=551, train_loss=551]Starting epoch 2/15
Batch 1/1
Batch data shape: (200, 28, 28, 1)
Train Loss: 551.1973876953125
Running validation...
Epoch 2, Step 0: Train Loss = 543.1773681640625, Test Loss = 543.1317138671875
Starting epoch 3/15
Batch 1/1
Batch data shape: (200, 28, 28, 1)
Train Loss: 543.1455078125
Running validation...
Epoch 3, Step 0: Train Loss = 530.9746704101562, Test Loss = 530.903076171875
  1%|▏         | 3/205 [00:00<00:31,  6.35it/s, epoch=2, test_loss=531, train_loss=531]Starting epoch 4/15
Batch 1/1
Batch data shape: (200, 28, 28, 1)
Train Loss: 531.0253295898438
Running validation...
Epoch 4, Step 0: Train Loss = 509.5491027832031, Test Loss = 509.0605773925781
  2%|▏         | 4/205 [00:00<00:29,  6.91it/s, epoch=3, test_loss=509, train_loss=510]Starting epoch 5/15
Batch 1/1
Batch data shape: (200, 28, 28, 1)
Train Loss: 509.25506591796875
Running validation...
Epoch 5, Step 0: Train Loss = 463.6889343261719, Test Loss = 464.38299560546875
  2%|▏         | 5/205 [00:00<00:26,  7.62it/s, epoch=4, test_loss=464, train_loss=464]Starting epoch 6/15
Batch 1/1
Batch data shape: (200, 28, 28, 1)
Train Loss: 463.956787109375
Running validation...
Epoch 6, Step 0: Train Loss = 364.67877197265625, Test Loss = 367.41192626953125
Starting epoch 7/15
Batch 1/1
Batch data shape: (200, 28, 28, 1)
Train Loss: 364.8996276855469
Running validation...
Epoch 7, Step 0: Train Loss = 241.7515869140625, Test Loss = 235.6400146484375
  3%|▎         | 7/205 [00:00<00:22,  8.78it/s, epoch=6, test_loss=236, train_loss=242]Starting epoch 8/15
Batch 1/1
Batch data shape: (200, 28, 28, 1)
Train Loss: 244.72702026367188
Running validation...
Epoch 8, Step 0: Train Loss = 145.60940551757812, Test Loss = 158.11660766601562
Starting epoch 9/15
Batch 1/1
  4%|▍         | 8/205 [00:01<00:22,  8.66it/s, epoch=7, test_loss=158, train_loss=146]Batch data shape: (200, 28, 28, 1)
Train Loss: 146.16184997558594
Running validation...
Epoch 9, Step 0: Train Loss = -16.22071075439453, Test Loss = -9.493881225585938
Starting epoch 10/15
Batch 1/1
Batch data shape: (200, 28, 28, 1)
Train Loss: 9.172378540039062
Running validation...
Epoch 10, Step 0: Train Loss = -154.66314697265625, Test Loss = -142.43350219726562
  5%|▍         | 10/205 [00:01<00:21,  9.27it/s, epoch=9, test_loss=-142, train_loss=-155]Starting epoch 11/15
Batch 1/1
Batch data shape: (200, 28, 28, 1)
Train Loss: -169.27108764648438
Running validation...
Epoch 11, Step 0: Train Loss = -499.44317626953125, Test Loss = -595.1812744140625
Starting epoch 12/15
Batch 1/1
Batch data shape: (200, 28, 28, 1)
Train Loss: -484.5697021484375
Running validation...
Epoch 12, Step 0: Train Loss = -1263.6300048828125, Test Loss = -1118.5853271484375
  6%|▌         | 12/205 [00:01<00:20,  9.63it/s, epoch=11, test_loss=-1.12e+3, train_loss=-1263.63]Starting epoch 13/15
Batch 1/1
Batch data shape: (200, 28, 28, 1)
Train Loss: -1306.788818359375
Running validation...
Epoch 13, Step 0: Train Loss = -3212.463623046875, Test Loss = -3655.08984375
  6%|▋         | 13/205 [00:01<00:19,  9.67it/s, epoch=12, test_loss=-3.66e+3, train_loss=-3.21e+3]Starting epoch 14/15
Batch 1/1
Batch data shape: (200, 28, 28, 1)
Train Loss: -2958.772216796875
Running validation...
Epoch 14, Step 0: Train Loss = -6527.02880859375, Test Loss = -5759.93994140625
  7%|▋         | 14/205 [00:01<00:20,  9.53it/s, epoch=13, test_loss=-5759.94, train_loss=-6.53e+3]Starting epoch 15/15
Batch 1/1
Batch data shape: (200, 28, 28, 1)
Train Loss: -6476.9345703125
Running validation...
Epoch 15, Step 0: Train Loss = -13856.73046875, Test Loss = -16909.171875


SOM initialization...

 17%|█▋        | 34/205 [00:02<00:09, 18.97it/s, epoch=3, test_loss=215, train_loss=227]           

Training...

 23%|██▎       | 48/205 [00:08<01:09,  2.26it/s, cah=[0.00080154446], cr_ratio=-1.37e+6, cs_ratio=0.171, epoch=12, ssom=[4.1588826], test_loss=-2.45e+7, train_loss=-3.42e+7, vae=[-29627388.0], vc_ratio=-2.99e+9]
INFO:tensorflow:Restoring parameters from ../models/hyperopt_100_8-8_2024-06-19_21164/hyperopt_100_8-8_2024-06-19_21164.ckpt
INFO - tensorflow - Restoring parameters from ../models/hyperopt_100_8-8_2024-06-19_21164/hyperopt_100_8-8_2024-06-19_21164.ckpt
Evaluation...
 90%|█████████ | 185/205 [01:14<00:08,  2.48it/s, cah=[nan], cr_ratio=nan, cs_ratio=nan, epoch=149, ssom=[nan], test_loss=nan, train_loss=nan, vae=[nan], vc_ratio=nan]

 NMI: 0.0, AMI: 0.0, PUR: 0.3575.  Name: %r.


 Time: 75.63386297225952
INFO - hyperopt - Result: {'NMI': 0.0, 'Purity': 0.3575, 'AMI': 0.0}
INFO - hyperopt - Completed after 0:01:16
